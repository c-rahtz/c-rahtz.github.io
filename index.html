<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<title>Craig Rahtz</title>
	<link href='http://fonts.googleapis.com/css?family=Open+Sans+Condensed:300' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" type="text/css" href="css/combined.css">
	<link rel="icon" type="image/x-icon" href="cr-bw-001.ico">
</head>

<body onload="cr.ready();">
	<div class="inner-space">

		<div id="page-head">
			<!-- <h1>Craig Rahtz</h1> -->
			<img id="image-container" src="img/dots-still.gif">
			<div id="play-gif-button" class="arrow-right" data-gif="dots-sweep.gif"></div>
			<!-- need to refactor this markup; size text blocks button event -->
			<h4 id="size-notice">9.2mb</h4>
		</div>
	</div>
 	
	<script type="text/javascript" src="https://code.createjs.com/preloadjs-0.6.0.min.js"></script>

	<script type="text/javascript">
		// keeping on-page script to reduce network calls - or just to keep things simple, heh

		//creating a global object to hold my methods and properties
		var cr = {
			handleFileComplete: function(e) {
				// console.log(e);
				cr.playBtn.style.display = "none";
				document.getElementById("size-notice").style.display = "none";
				document.getElementById("image-container").src = e.result.src;
			},
			handleFileProgress: function(e) {
				var perc;
				perc = e.progress * 100;
				perc = perc + "%"
				document.getElementById("size-notice").innerHTML = perc;

			},
			loadImage: function(img) {
				var imgPath, sizeNotice, preload;
				imgPath = document.getElementById("image-container");
				// console.log(img);
				document.getElementById("size-notice").innerHTML = "0%";
				imgPath = "img/" + img;
				//console.log(imgPath);
				cr.preload.loadFile(imgPath);

			},
			playClick: function(e) {
				var btn, imageToLoad;
				btn = e.currentTarget;
				imageToLoad = btn.getAttribute("data-gif");
				
				//console.log(imageToLoad);
				//console.log("Play click.");
				
				// cannot use 'this' below; must use explicit object because 'this'
				// is different inside the event listener
				// check this ish out sometime - http://www.w3.org/TR/DOM-Level-3-Events/#event-flow
				//console.log(this); 
				cr.loadImage(imageToLoad);
			},
			addlisteners: function(){
				//console.log("Adding listeners.");
				// playBtn is created in ready() and is then available in the cr object
				this.playBtn.addEventListener("click", this.playClick);
				this.preload = new createjs.LoadQueue();
				this.preload.addEventListener("fileload", cr.handleFileComplete);
				this.preload.addEventListener("fileprogress", cr.handleFileProgress);
			},
			ready: function() {
				//console.log("We are young.");
				// declaring these variables here creates them in the local object space
				this.playBtn = document.getElementById("play-gif-button");
				this.playBtn.style.display = "block";
				this.addlisteners();
			},

		}

	</script>

</body>

</html>